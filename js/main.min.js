"use strict";var date=new Date,month=date.getMonth(),year=date.getFullYear(),monthPrev=document.querySelector(".calendar__btn--prev"),monthNext=document.querySelector(".calendar__btn--next"),today=document.querySelector(".calendar__btn--today"),months=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthsNote=["Января","Февраля","Марта","Апреля","Мая","Июня","Июля","Августа","Сентября","Октября","Ноября","Декабря"],calDay=document.querySelectorAll(".calendar__box");function getWeekDay(e){return["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"][e.getDay()]}function getLastDayWeekOfMonth(e,t){return new Date(e,t,0).getDay()-1}function getLastDayOfMonth(e,t){return new Date(e,t,0).getDate()}function addDay(){var e,t=0;for(e=getLastDayWeekOfMonth(year,month);0<=e;e--){calDay[e].style.display="table-cell",calDay[e].classList.add("calendar__box--last"),calDay[e].querySelector(".calendar__day").textContent=getLastDayOfMonth(year,month)-t,t++}for(t=1,e=getLastDayWeekOfMonth(year,month)+1;e<=getLastDayOfMonth(year,month+1)+getLastDayWeekOfMonth(year,month);e++){if(calDay[e].style.display="table-cell",calDay[e].classList.remove("calendar__box--last"),(calDay[e].querySelector(".calendar__day").textContent=t)==getLastDayOfMonth(year,month+1))for(e++;e<calDay.length;e++)calDay[e].style.display="none";t++}year==date.getFullYear()&&month==date.getMonth()&&calDay[getLastDayWeekOfMonth(year,month)+date.getDate()].classList.add("calendar__box--active")}document.querySelector(".months").textContent=months[month],document.querySelector(".year").textContent=year,addDay(),today.addEventListener("click",function(e){e.preventDefault(),month=date.getMonth(),year=date.getFullYear(),document.querySelector(".year").textContent=year,document.querySelector(".months").textContent=months[month],addDay()}),monthPrev.addEventListener("click",function(e){e.preventDefault(),calDay[getLastDayWeekOfMonth(year,month)+date.getDate()].classList.remove("calendar__box--active"),(month-=1)<0&&(month=11,year-=1,document.querySelector(".year").textContent=year),document.querySelector(".months").textContent=months[month],addDay()}),monthNext.addEventListener("click",function(e){e.preventDefault(),calDay[getLastDayWeekOfMonth(year,month)+date.getDate()].classList.remove("calendar__box--active"),11<(month+=1)&&(month=0,year+=1,document.querySelector(".year").textContent=year),document.querySelector(".months").textContent=months[month],addDay()});var note=document.querySelector(".note"),noteClose=document.querySelector(".note__form-btn--close"),noteSave=document.querySelector(".note__form-btn--save"),overlay=document.querySelector(".overlay");calDay.forEach(function(a,t){var o=document.querySelectorAll(".calendar__day");a.addEventListener("click",function(e){e.preventDefault();var n=a.innerHTML;a.classList.contains("calendar__box--last")||(note.classList.add("note__show"),note.classList.add("note__show-animation"),overlay.classList.add("overlay__show"),document.querySelector(".note__day").textContent=o[t].textContent,document.querySelector(".note__months").textContent=monthsNote[month],document.querySelector(".note__year").textContent=year,noteSave.addEventListener("click",function(e){e.preventDefault();var t=note.querySelector(".note__form-txt-area--event").value;a.innerHTML=n+'<div class="calendar__note">\n            <span class="calendar__note-time"></span>\n            <span class="calendar__note-event">'+t+'</span>\n            <span class="calendar__note-person"></span>\n          </div>',note.classList.remove("note__show"),note.classList.remove("note__show-animation"),overlay.classList.remove("overlay__show")}),noteClose.addEventListener("click",function(){note.classList.remove("note__show"),note.classList.remove("note__show-animation"),overlay.classList.remove("overlay__show")}),window.addEventListener("keydown",function(e){27===e.keyCode&&note.classList.contains("note__show")&&(note.classList.remove("note__show"),overlay.classList.remove("overlay__show"),note.classList.remove("note__show-animation"))}))})});